# PPCCD 项目

该项目利用细胞空间位置信息构建细胞互作网络，通过社区发现算法挖掘细胞聚集模式（社区），并提取社区特征，最终用于患者的预后预测。

## 工作流程

项目代码按照数字顺序分为五个主要步骤：

1.  **提取坐标位置以及构建边表**:
    -   脚本从原始数据（如Excel、CSV和图像文件）中读取细胞的坐标和类型信息。
    -   基于细胞间的空间邻近关系（例如，通过三角剖分）构建细胞互作网络，并将其表示为边表。

2.  **社区发现**:
    -   使用 `networkx` 和 `cdlib` 等库，根据第一步生成的边表构建图。
    -   应用多种社区发现算法（如Louvain, LPA等）来识别细胞网络中的紧密连接的子群（社区）。

3.  **特征提取**:
    -   针对每个检测到的社区，计算一系列生物学相关的特征。
    -   这些特征包括：社区内的细胞数量、各类细胞的百分比、不同细胞类型之间的连接数、平均连接距离等。

4.  **特征数据融合**:
    -   由于实验数据可能来自不同的Panel，此步骤将多个Panel的特征数据按患者ID进行合并。
    -   通过对同一患者的特征取平均值，生成一个统一的特征矩阵。

5.  **预后预测**:
    -   使用强大的自动化机器学习库 `AutoGluon`。
    -   基于融合后的特征数据训练一个表格预测模型，用于预测患者的预后标签（如生存状态、治疗反应等）。
    -   脚本还包含模型评估和特征重要性分析的功能。

## 依赖库

您需要安装以下Python库来运行此项目：

-   `pandas`
-   `numpy`
-   `openpyxl`
-   `matplotlib`
-   `opencv-python` (cv2)
-   `networkx`
-   `cdlib`
-   `scipy`
-   `scikit-learn`
-   `autogluon`

您可以使用pip来安装它们：
```bash
pip install pandas numpy openpyxl matplotlib opencv-python networkx cdlib scipy scikit-learn autogluon
```

## 如何使用

1.  **准备数据**: 将您的数据集放置在指定目录中。
2.  **修改路径**: **非常重要**，项目中的所有Python脚本都包含了**硬编码的文件路径**（例如 `E:/研一/Community-Detection/dataset/...`）。在运行前，您必须手动将这些路径修改为您自己存放数据的实际路径。
3.  **按顺序执行脚本**:
    -   运行 `1.提取坐标位置以及构建边表/` 中的脚本来生成边表。
    -   运行 `2.社区发现/` 中的脚本来识别社区。
    -   运行 `3.特征提取/` 中的脚本来计算社区特征。
    -   运行 `4.按照患者ID进行两个panel特征数据的融合/` 中的脚本来合并特征。
    -   运行 `5.预后预测/` 中的脚本来训练模型并进行预测。
